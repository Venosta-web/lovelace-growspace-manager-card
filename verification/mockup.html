<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <title>Growspace Manager Card Mockup</title>
  <script src="https://unpkg.com/lit/polyfill-support.js"></script>
  <script type="module" src="/dist/growspace-manager-card.js"></script>
  <style>
    body {
      background-color: #202020;
      color: white;
      font-family: Roboto, sans-serif;
      padding: 20px;
    }
    /* Mock Home Assistant CSS vars */
    :root {
      --primary-color: #03a9f4;
      --primary-text-color: #ffffff;
      --secondary-text-color: #b3b3b3;
      --divider-color: #444;
      --card-background-color: #1c1c1c;
      --growspace-card-bg: rgba(30, 30, 30, 0.6);
      --growspace-card-text: #fff;
    }
  </style>
</head>
<body>

  <growspace-manager-card id="card"></growspace-manager-card>

  <script>
    const card = document.getElementById('card');

    // Mock Home Assistant object
    const hass = {
      states: {
        'sensor.growspaces_list': {
          attributes: {
            growspaces: {
              'gs1': 'Growspace 1'
            }
          }
        },
        'sensor.gs1_optimal_conditions': {
           attributes: {
              temperature: 24,
              humidity: 60,
              vpd: 1.2,
              co2: 800,
              is_lights_on: true
           },
           last_changed: new Date().toISOString()
        },
        'sensor.gs1_overview': {
           entity_id: 'sensor.gs1_overview',
           attributes: {
             growspace_id: 'gs1',
             friendly_name: 'Main Tent',
             rows: 2,
             plants_per_row: 2,
             type: 'normal'
           }
        },
        'sensor.plant1': {
           entity_id: 'sensor.plant1',
           state: 'vegetative',
           attributes: {
             growspace_id: 'gs1',
             row: 1,
             col: 1,
             strain: 'Blue Dream',
             phenotype: '#1'
           }
        },
        'sensor.growspace_strain_library': {
           attributes: {
              strains: {
                 'Blue Dream': {
                    phenotypes: {
                       '#1': { image: '' }
                    }
                 }
              }
           }
        }
      },
      callService: async (domain, service, data) => {
        console.log(`Call Service: ${domain}.${service}`, data);
        if (service === 'add_strain') {
           return Promise.resolve();
        }
      },
      callApi: async () => [],
      config: { time_zone: 'UTC' }
    };

    // Mock configuration
    const config = {
      type: 'custom:growspace-manager-card',
      title: 'My Grow',
      default_growspace: 'gs1'
    };

    // Wait for the element to be defined before setting properties
    customElements.whenDefined('growspace-manager-card').then(() => {
        console.log("Card defined, setting props");
        card.setConfig(config);
        card.hass = hass;
        // Force update just in case
        if (card.requestUpdate) card.requestUpdate();
    });

  </script>
</body>
</html>
